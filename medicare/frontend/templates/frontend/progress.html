{% extends 'frontend/base.html' %}

{% block title %}–ú—ñ–π –ø—Ä–æ–≥—Ä–µ—Å - Medicare{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
    <div class="row mb-4">
        <div class="col-lg-8">
            <h1 class="h2 mb-3">–ú—ñ–π –ø—Ä–æ–≥—Ä–µ—Å —Ä–µ–∞–±—ñ–ª—ñ—Ç–∞—Ü—ñ—ó</h1>
            <p class="text-muted">–í—ñ–¥—Å—Ç–µ–∂—É–π—Ç–µ —Å–≤—ñ–π –ø—Ä–æ–≥—Ä–µ—Å —Ç–∞ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è –≤ —Ä–µ–∞–±—ñ–ª—ñ—Ç–∞—Ü—ñ—ó</p>
        </div>
        <div class="col-lg-4 text-lg-end">
            <div class="btn-group" role="group">
                <button class="btn btn-outline-primary" id="add-progress-btn">
                    <i class="fas fa-plus me-2"></i>–î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å
                </button>
                <button class="btn btn-primary" id="generate-report-btn">
                    <i class="fas fa-file-pdf me-2"></i>–ó–≤—ñ—Ç
                </button>
            </div>
        </div>
    </div>

    <!-- –ó–∞–≥–∞–ª—å–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <div class="progress-ring mb-3">
                        <svg class="progress-ring-svg" width="80" height="80">
                            <circle class="progress-ring-circle-bg" cx="40" cy="40" r="30"></circle>
                            <circle class="progress-ring-circle" cx="40" cy="40" r="30" id="overall-progress-ring"></circle>
                        </svg>
                        <div class="progress-ring-text" id="overall-progress-text">0%</div>
                    </div>
                    <h5 class="mb-1">–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å</h5>
                    <small class="text-muted">–ó–∞ –≤–µ—Å—å —á–∞—Å</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <i class="fas fa-calendar-check fa-3x text-success mb-3"></i>
                    <h4 class="mb-1" id="completed-sessions">0</h4>
                    <h6 class="text-muted">–ó–∞–≤–µ—Ä—à–µ–Ω–∏—Ö —Å–µ—Å—ñ–π</h6>
                    <small class="text-success" id="sessions-change">+0 —Ü—å–æ–≥–æ —Ç–∏–∂–Ω—è</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <i class="fas fa-chart-line fa-3x text-primary mb-3"></i>
                    <h4 class="mb-1" id="improvement-score">0</h4>
                    <h6 class="text-muted">–ë–∞–ª –ø–æ–∫—Ä–∞—â–µ–Ω–Ω—è</h6>
                    <small class="text-primary" id="score-change">+0 –∑–∞ –º—ñ—Å—è—Ü—å</small>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card stats-card h-100">
                <div class="card-body text-center">
                    <i class="fas fa-target fa-3x text-warning mb-3"></i>
                    <h4 class="mb-1" id="goals-achieved">0</h4>
                    <h6 class="text-muted">–î–æ—Å—è–≥–Ω—É—Ç—ñ —Ü—ñ–ª—ñ</h6>
                    <small class="text-warning" id="goals-total">–∑ 0 –∑–∞–≥–∞–ª–æ–º</small>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- –ù–∞–≤—ñ–≥–∞—Ü—ñ—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º -->
        <div class="col-lg-3">
            <div class="card sticky-top" style="top: 100px;">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="fas fa-list me-2"></i>–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –ø—Ä–æ–≥—Ä–µ—Å—É
                    </h5>
                </div>
                <div class="list-group list-group-flush" id="progress-categories">
                    <a href="#" class="list-group-item list-group-item-action active" data-category="all">
                        <i class="fas fa-chart-line me-2"></i>–í–µ—Å—å –ø—Ä–æ–≥—Ä–µ—Å
                        <span class="badge bg-primary rounded-pill float-end" id="all-count">0</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-category="mobility">
                        <i class="fas fa-walking me-2"></i>–ú–æ–±—ñ–ª—å–Ω—ñ—Å—Ç—å
                        <span class="badge bg-secondary rounded-pill float-end" id="mobility-count">0</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-category="strength">
                        <i class="fas fa-dumbbell me-2"></i>–°–∏–ª–∞
                        <span class="badge bg-secondary rounded-pill float-end" id="strength-count">0</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-category="flexibility">
                        <i class="fas fa-expand-arrows-alt me-2"></i>–ì–Ω—É—á–∫—ñ—Å—Ç—å
                        <span class="badge bg-secondary rounded-pill float-end" id="flexibility-count">0</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-category="balance">
                        <i class="fas fa-balance-scale me-2"></i>–†—ñ–≤–Ω–æ–≤–∞–≥–∞
                        <span class="badge bg-secondary rounded-pill float-end" id="balance-count">0</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-category="pain">
                        <i class="fas fa-heart-broken me-2"></i>–ë—ñ–ª—å
                        <span class="badge bg-secondary rounded-pill float-end" id="pain-count">0</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-category="cognitive">
                        <i class="fas fa-brain me-2"></i>–ö–æ–≥–Ω—ñ—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
                        <span class="badge bg-secondary rounded-pill float-end" id="cognitive-count">0</span>
                    </a>
                    <a href="#" class="list-group-item list-group-item-action" data-category="speech">
                        <i class="fas fa-comments me-2"></i>–ú–æ–≤–ª–µ–Ω–Ω—è
                        <span class="badge bg-secondary rounded-pill float-end" id="speech-count">0</span>
                    </a>
                </div>

                <!-- –§—ñ–ª—å—Ç—Ä–∏ –ø–æ –ø–µ—Ä—ñ–æ–¥—É -->
                <div class="card-body">
                    <h6 class="card-subtitle mb-3">–ü–µ—Ä—ñ–æ–¥</h6>
                    <select class="form-select mb-3" id="period-filter">
                        <option value="week">–¶–µ–π —Ç–∏–∂–¥–µ–Ω—å</option>
                        <option value="month" selected>–¶–µ–π –º—ñ—Å—è—Ü—å</option>
                        <option value="quarter">–¶–µ–π –∫–≤–∞—Ä—Ç–∞–ª</option>
                        <option value="year">–¶–µ–π —Ä—ñ–∫</option>
                        <option value="all">–í–µ—Å—å —á–∞—Å</option>
                    </select>

                    <h6 class="card-subtitle mb-3">–¢–∏–ø –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è</h6>
                    <div class="btn-group w-100" role="group">
                        <input type="radio" class="btn-check" name="view-type" id="chart-view" checked>
                        <label class="btn btn-outline-primary" for="chart-view">
                            <i class="fas fa-chart-line"></i>
                        </label>
                        <input type="radio" class="btn-check" name="view-type" id="list-view">
                        <label class="btn btn-outline-primary" for="list-view">
                            <i class="fas fa-list"></i>
                        </label>
                        <input type="radio" class="btn-check" name="view-type" id="calendar-view">
                        <label class="btn btn-outline-primary" for="calendar-view">
                            <i class="fas fa-calendar"></i>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="col-lg-9">
            <!-- –ì—Ä–∞—Ñ—ñ–∫ –ø—Ä–æ–≥—Ä–µ—Å—É -->
            <div class="card mb-4" id="progress-chart-card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0" id="chart-title">–ü—Ä–æ–≥—Ä–µ—Å –∑–∞ –º—ñ—Å—è—Ü—å</h5>
                    <div class="btn-group btn-group-sm" role="group">
                        <input type="radio" class="btn-check" name="chart-type" id="line-chart" checked>
                        <label class="btn btn-outline-secondary" for="line-chart">–õ—ñ–Ω—ñ–π–Ω–∏–π</label>
                        <input type="radio" class="btn-check" name="chart-type" id="bar-chart">
                        <label class="btn btn-outline-secondary" for="bar-chart">–°—Ç–æ–≤–ø—á–∞—Å—Ç–∏–π</label>
                    </div>
                </div>
                <div class="card-body">
                    <div class="chart-container">
                        <canvas id="progress-chart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>

            <!-- –û—Å—Ç–∞–Ω–Ω—ñ –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–≥—Ä–µ—Å—É -->
            <div class="card mb-4" id="progress-list-card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="card-title mb-0">–û—Å—Ç–∞–Ω–Ω—ñ –∑–∞–ø–∏—Å–∏</h5>
                    <button class="btn btn-sm btn-outline-primary" id="view-all-records">
                        –ü–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ –≤—Å—ñ
                    </button>
                </div>
                <div class="card-body">
                    <div id="progress-records">
                        <div class="text-center py-5">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- –ö–∞–ª–µ–Ω–¥–∞—Ä –ø—Ä–æ–≥—Ä–µ—Å—É -->
            <div class="card" id="progress-calendar-card" style="display: none;">
                <div class="card-header">
                    <h5 class="card-title mb-0">–ö–∞–ª–µ–Ω–¥–∞—Ä –ø—Ä–æ–≥—Ä–µ—Å—É</h5>
                </div>
                <div class="card-body">
                    <div id="progress-calendar"></div>
                </div>
            </div>

            <!-- –¶—ñ–ª—ñ —Ç–∞ –∑–∞–≤–¥–∞–Ω–Ω—è -->
            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-bullseye me-2"></i>–ü–æ—Ç–æ—á–Ω—ñ —Ü—ñ–ª—ñ
                            </h5>
                            <button class="btn btn-sm btn-outline-primary" id="add-goal-btn">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>
                        <div class="card-body">
                            <div id="current-goals">
                                <div class="text-center py-3">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">
                                <i class="fas fa-trophy me-2"></i>–î–æ—Å—è–≥–Ω–µ–Ω–Ω—è
                            </h5>
                        </div>
                        <div class="card-body">
                            <div id="achievements">
                                <div class="text-center py-3">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –ø—Ä–æ–≥—Ä–µ—Å—É -->
<div class="modal fade" id="addProgressModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å –ø—Ä–æ–≥—Ä–µ—Å—É</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="add-progress-form">
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="progress-category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                                <select class="form-select" id="progress-category" name="category" required>
                                    <option value="">–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>
                                    <option value="mobility">–ú–æ–±—ñ–ª—å–Ω—ñ—Å—Ç—å</option>
                                    <option value="strength">–°–∏–ª–∞</option>
                                    <option value="flexibility">–ì–Ω—É—á–∫—ñ—Å—Ç—å</option>
                                    <option value="balance">–†—ñ–≤–Ω–æ–≤–∞–≥–∞</option>
                                    <option value="pain">–ë—ñ–ª—å</option>
                                    <option value="cognitive">–ö–æ–≥–Ω—ñ—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó</option>
                                    <option value="speech">–ú–æ–≤–ª–µ–Ω–Ω—è</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="progress-date" class="form-label">–î–∞—Ç–∞</label>
                                <input type="date" class="form-control" id="progress-date" name="date" required>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="progress-metric" class="form-label">–ü–æ–∫–∞–∑–Ω–∏–∫</label>
                        <select class="form-select" id="progress-metric" name="metric" required>
                            <option value="">–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>
                        </select>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="progress-value" class="form-label">–ó–Ω–∞—á–µ–Ω–Ω—è</label>
                                <div class="input-group">
                                    <input type="number" class="form-control" id="progress-value" name="value" step="0.1" required>
                                    <span class="input-group-text" id="progress-unit">–æ–¥.</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="progress-rating" class="form-label">–°–∞–º–æ–æ—Ü—ñ–Ω–∫–∞ (1-10)</label>
                                <input type="range" class="form-range" id="progress-rating" name="rating" min="1" max="10" value="5">
                                <div class="d-flex justify-content-between">
                                    <small>1 - –î—É–∂–µ –ø–æ–≥–∞–Ω–æ</small>
                                    <small id="rating-value">5</small>
                                    <small>10 - –í—ñ–¥–º—ñ–Ω–Ω–æ</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="progress-notes" class="form-label">–ü—Ä–∏–º—ñ—Ç–∫–∏</label>
                        <textarea class="form-control" id="progress-notes" name="notes" rows="3" placeholder="–î–æ–¥–∞–π—Ç–µ –∫–æ–º–µ–Ω—Ç–∞—Ä—ñ –ø—Ä–æ –≤–∞—à —Å—Ç–∞–Ω, –≤–ø—Ä–∞–≤–∏, —è–∫—ñ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∏, —Ç–æ—â–æ..."></textarea>
                    </div>

                    <div class="mb-3">
                        <label for="progress-mood" class="form-label">–ù–∞—Å—Ç—Ä—ñ–π</label>
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="mood" value="1" id="mood-1">
                            <label class="btn btn-outline-danger" for="mood-1">üòû</label>
                            <input type="radio" class="btn-check" name="mood" value="2" id="mood-2">
                            <label class="btn btn-outline-warning" for="mood-2">üòê</label>
                            <input type="radio" class="btn-check" name="mood" value="3" id="mood-3" checked>
                            <label class="btn btn-outline-primary" for="mood-3">üôÇ</label>
                            <input type="radio" class="btn-check" name="mood" value="4" id="mood-4">
                            <label class="btn btn-outline-success" for="mood-4">üòä</label>
                            <input type="radio" class="btn-check" name="mood" value="5" id="mood-5">
                            <label class="btn btn-outline-success" for="mood-5">üòÑ</label>
                        </div>
                    </div>

                    <div class="mb-3">
                        <div class="form-check">
                            <input class="form-check-input" type="checkbox" id="progress-share" name="share_with_doctor">
                            <label class="form-check-label" for="progress-share">
                                –ü–æ–¥—ñ–ª–∏—Ç–∏—Å—è –∑ –ª—ñ–∫–∞—Ä–µ–º
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>–ó–±–µ—Ä–µ–≥—Ç–∏
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ü—ñ–ª—ñ -->
<div class="modal fade" id="addGoalModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ü—ñ–ª—å</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="add-goal-form">
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="goal-title" class="form-label">–ù–∞–∑–≤–∞ —Ü—ñ–ª—ñ</label>
                        <input type="text" class="form-control" id="goal-title" name="title" required>
                    </div>

                    <div class="mb-3">
                        <label for="goal-description" class="form-label">–û–ø–∏—Å</label>
                        <textarea class="form-control" id="goal-description" name="description" rows="3"></textarea>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="goal-category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                                <select class="form-select" id="goal-category" name="category" required>
                                    <option value="">–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>
                                    <option value="mobility">–ú–æ–±—ñ–ª—å–Ω—ñ—Å—Ç—å</option>
                                    <option value="strength">–°–∏–ª–∞</option>
                                    <option value="flexibility">–ì–Ω—É—á–∫—ñ—Å—Ç—å</option>
                                    <option value="balance">–†—ñ–≤–Ω–æ–≤–∞–≥–∞</option>
                                    <option value="pain">–ë—ñ–ª—å</option>
                                    <option value="cognitive">–ö–æ–≥–Ω—ñ—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó</option>
                                    <option value="speech">–ú–æ–≤–ª–µ–Ω–Ω—è</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="goal-target-date" class="form-label">–¶—ñ–ª—å–æ–≤–∞ –¥–∞—Ç–∞</label>
                                <input type="date" class="form-control" id="goal-target-date" name="target_date" required>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="goal-current-value" class="form-label">–ü–æ—Ç–æ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è</label>
                                <input type="number" class="form-control" id="goal-current-value" name="current_value" step="0.1">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="goal-target-value" class="form-label">–¶—ñ–ª—å–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è</label>
                                <input type="number" class="form-control" id="goal-target-value" name="target_value" step="0.1" required>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="goal-priority" class="form-label">–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç</label>
                        <select class="form-select" id="goal-priority" name="priority">
                            <option value="low">–ù–∏–∑—å–∫–∏–π</option>
                            <option value="medium" selected>–°–µ—Ä–µ–¥–Ω—ñ–π</option>
                            <option value="high">–í–∏—Å–æ–∫–∏–π</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-bullseye me-2"></i>–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ü—ñ–ª—å
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ –¥–µ—Ç–∞–ª–µ–π –∑–∞–ø–∏—Å—É -->
<div class="modal fade" id="progressDetailsModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–µ—Ç–∞–ª—ñ –∑–∞–ø–∏—Å—É</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="row mb-3">
                    <div class="col-6">
                        <strong>–ö–∞—Ç–µ–≥–æ—Ä—ñ—è:</strong>
                        <span id="detail-category"></span>
                    </div>
                    <div class="col-6">
                        <strong>–î–∞—Ç–∞:</strong>
                        <span id="detail-date"></span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-6">
                        <strong>–ü–æ–∫–∞–∑–Ω–∏–∫:</strong>
                        <span id="detail-metric"></span>
                    </div>
                    <div class="col-6">
                        <strong>–ó–Ω–∞—á–µ–Ω–Ω—è:</strong>
                        <span id="detail-value"></span>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-6">
                        <strong>–°–∞–º–æ–æ—Ü—ñ–Ω–∫–∞:</strong>
                        <span id="detail-rating"></span>
                    </div>
                    <div class="col-6">
                        <strong>–ù–∞—Å—Ç—Ä—ñ–π:</strong>
                        <span id="detail-mood"></span>
                    </div>
                </div>
                <div class="mb-3">
                    <strong>–ü—Ä–∏–º—ñ—Ç–∫–∏:</strong>
                    <p id="detail-notes" class="mt-2"></p>
                </div>
                <div class="progress-trend mb-3">
                    <strong>–¢—Ä–µ–Ω–¥:</strong>
                    <span id="detail-trend"></span>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä–∏—Ç–∏</button>
                <button type="button" class="btn btn-outline-primary" id="edit-progress-btn">
                    <i class="fas fa-edit me-2"></i>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏
                </button>
                <button type="button" class="btn btn-outline-danger" id="delete-progress-btn">
                    <i class="fas fa-trash me-2"></i>–í–∏–¥–∞–ª–∏—Ç–∏
                </button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–µ –≤—ñ–∫–Ω–æ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è —Ü—ñ–ª—ñ -->
<div class="modal fade" id="editGoalModal" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ü—ñ–ª—å</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <form id="edit-goal-form">
                <div class="modal-body">
                    <input type="hidden" id="edit-goal-id">
                    
                    <div class="mb-3">
                        <label for="edit-goal-title" class="form-label">–ù–∞–∑–≤–∞ —Ü—ñ–ª—ñ</label>
                        <input type="text" class="form-control" id="edit-goal-title" name="title" required>
                    </div>

                    <div class="mb-3">
                        <label for="edit-goal-description" class="form-label">–û–ø–∏—Å</label>
                        <textarea class="form-control" id="edit-goal-description" name="description" rows="3"></textarea>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-goal-category" class="form-label">–ö–∞—Ç–µ–≥–æ—Ä—ñ—è</label>
                                <select class="form-select" id="edit-goal-category" name="category" required>
                                    <option value="">–û–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>
                                    <option value="mobility">–ú–æ–±—ñ–ª—å–Ω—ñ—Å—Ç—å</option>
                                    <option value="strength">–°–∏–ª–∞</option>
                                    <option value="flexibility">–ì–Ω—É—á–∫—ñ—Å—Ç—å</option>
                                    <option value="balance">–†—ñ–≤–Ω–æ–≤–∞–≥–∞</option>
                                    <option value="pain">–ë—ñ–ª—å</option>
                                    <option value="cognitive">–ö–æ–≥–Ω—ñ—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó</option>
                                    <option value="speech">–ú–æ–≤–ª–µ–Ω–Ω—è</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-goal-target-date" class="form-label">–¶—ñ–ª—å–æ–≤–∞ –¥–∞—Ç–∞</label>
                                <input type="date" class="form-control" id="edit-goal-target-date" name="target_date" required>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-goal-current-value" class="form-label">–ü–æ—Ç–æ—á–Ω–µ –∑–Ω–∞—á–µ–Ω–Ω—è</label>
                                <input type="number" class="form-control" id="edit-goal-current-value" name="current_value" step="0.1">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label for="edit-goal-target-value" class="form-label">–¶—ñ–ª—å–æ–≤–µ –∑–Ω–∞—á–µ–Ω–Ω—è</label>
                                <input type="number" class="form-control" id="edit-goal-target-value" name="target_value" step="0.1" required>
                            </div>
                        </div>
                    </div>

                    <div class="mb-3">
                        <label for="edit-goal-priority" class="form-label">–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç</label>
                        <select class="form-select" id="edit-goal-priority" name="priority">
                            <option value="low">–ù–∏–∑—å–∫–∏–π</option>
                            <option value="medium">–°–µ—Ä–µ–¥–Ω—ñ–π</option>
                            <option value="high">–í–∏—Å–æ–∫–∏–π</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save me-2"></i>–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
    .stats-card {
        transition: transform 0.2s, box-shadow 0.2s;
        border: 1px solid #e9ecef;
        border-radius: 15px;
    }

    .stats-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    }

    .progress-ring {
        position: relative;
        display: inline-block;
    }

    .progress-ring-svg {
        transform: rotate(-90deg);
    }

    .progress-ring-circle-bg {
        stroke: #e9ecef;
        stroke-width: 4;
        fill: transparent;
    }

    .progress-ring-circle {
        stroke: #007bff;
        stroke-width: 4;
        stroke-linecap: round;
        fill: transparent;
        stroke-dasharray: 188.4;
        stroke-dashoffset: 188.4;
        transition: stroke-dashoffset 0.5s ease-in-out;
    }

    .progress-ring-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 1.2rem;
        font-weight: bold;
        color: #007bff;
    }

    .progress-record {
        border: 1px solid #e9ecef;
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
        transition: all 0.2s;
        cursor: pointer;
    }

    .progress-record:hover {
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        transform: translateY(-2px);
    }

    .progress-record.improved {
        border-left: 4px solid #28a745;
        background: linear-gradient(90deg, rgba(40, 167, 69, 0.1) 0%, transparent 100%);
    }

    .progress-record.declined {
        border-left: 4px solid #dc3545;
        background: linear-gradient(90deg, rgba(220, 53, 69, 0.1) 0%, transparent 100%);
    }

    .progress-record.stable {
        border-left: 4px solid #ffc107;
        background: linear-gradient(90deg, rgba(255, 193, 7, 0.1) 0%, transparent 100%);
    }

    .category-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.2rem;
        color: white;
        margin-right: 1rem;
    }

    .category-mobility { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    .category-strength { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .category-flexibility { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .category-balance { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); }
    .category-pain { background: linear-gradient(135deg, #fa709a 0%, #fee140 100%); }
    .category-cognitive { background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%); }
    .category-speech { background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%); }

    .trend-up {
        color: #28a745;
    }

    .trend-down {
        color: #dc3545;
    }

    .trend-stable {
        color: #ffc107;
    }

    .goal-card {
        border: 1px solid #e9ecef;
        border-radius: 12px;
        padding: 1rem;
        margin-bottom: 1rem;
        transition: all 0.2s;
    }

    .goal-card:hover {
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    }

    .goal-progress {
        height: 8px;
        border-radius: 4px;
        overflow: hidden;
        background-color: #e9ecef;
    }

    .goal-progress-bar {
        height: 100%;
        transition: width 0.5s ease-in-out;
    }

    .priority-high { border-left: 4px solid #dc3545; }
    .priority-medium { border-left: 4px solid #ffc107; }
    .priority-low { border-left: 4px solid #28a745; }

    .achievement-badge {
        background: linear-gradient(135deg, #ffd700 0%, #ffed4a 100%);
        color: #333;
        border-radius: 15px;
        padding: 0.5rem 1rem;
        margin: 0.25rem;
        display: inline-block;
        font-size: 0.9rem;
        font-weight: 500;
        box-shadow: 0 2px 8px rgba(255, 215, 0, 0.3);
    }

    .mood-emoji {
        font-size: 1.5rem;
    }

    .rating-display {
        display: flex;
        align-items: center;
    }

    .rating-bar {
        width: 60px;
        height: 8px;
        background-color: #e9ecef;
        border-radius: 4px;
        margin: 0 0.5rem;
        overflow: hidden;
    }

    .rating-fill {
        height: 100%;
        transition: width 0.3s ease;
    }

    .rating-1, .rating-2, .rating-3 { background-color: #dc3545; }
    .rating-4, .rating-5, .rating-6 { background-color: #ffc107; }
    .rating-7, .rating-8, .rating-9, .rating-10 { background-color: #28a745; }

    .chart-container {
        position: relative;
        height: 300px;
    }

    .calendar-day {
        position: relative;
        min-height: 100px;
        border: 1px solid #e9ecef;
        padding: 0.5rem;
    }

    .calendar-day.has-progress {
        background-color: #e3f2fd;
    }

    .calendar-day.has-progress::after {
        content: '';
        position: absolute;
        top: 0.5rem;
        right: 0.5rem;
        width: 8px;
        height: 8px;
        background-color: #2196f3;
        border-radius: 50%;
    }

    .empty-state {
        text-align: center;
        padding: 3rem 1rem;
        color: #6c757d;
    }

    .empty-state i {
        font-size: 3rem;
        margin-bottom: 1rem;
        color: #dee2e6;
    }

    .timeline {
        position: relative;
        padding-left: 2rem;
    }

    .timeline::before {
        content: '';
        position: absolute;
        left: 1rem;
        top: 0;
        bottom: 0;
        width: 2px;
        background: linear-gradient(to bottom, #007bff, #28a745);
    }

    .timeline-item {
        position: relative;
        margin-bottom: 2rem;
    }

    .timeline-dot {
        position: absolute;
        left: -2rem;
        top: 0.5rem;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: #007bff;
        border: 2px solid white;
        box-shadow: 0 0 0 2px #007bff;
    }

    @media (max-width: 768px) {
        .progress-record {
            padding: 0.75rem;
        }

        .category-icon {
            width: 30px;
            height: 30px;
            font-size: 1rem;
            margin-right: 0.75rem;
        }

        .chart-container {
            height: 250px;
        }

        .timeline {
            padding-left: 1.5rem;
        }

        .timeline-dot {
            left: -1.5rem;
        }
    }
</style>
{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    $(document).ready(function() {
        let currentCategory = 'all';
        let currentPeriod = 'month';
        let currentViewType = 'chart';
        let progressChart = null;
        let selectedProgressId = null;

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        loadOverallStats();
        loadProgressRecords();
        loadGoals();
        loadAchievements();
        setupEventHandlers();

        // –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ø–æ—Ç–æ—á–Ω–æ—ó –¥–∞—Ç–∏
        $('#progress-date').val(new Date().toISOString().split('T')[0]);

        // –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–æ—ó –¥–∞—Ç–∏ –¥–ª—è —Ü—ñ–ª–µ–π
        const tomorrow = new Date();
        tomorrow.setDate(tomorrow.getDate() + 1);
        $('#goal-target-date').attr('min', tomorrow.toISOString().split('T')[0]);
    });

    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –ø–æ–¥—ñ–π
    function setupEventHandlers() {
        // –ö–∞—Ç–µ–≥–æ—Ä—ñ—ó –ø—Ä–æ–≥—Ä–µ—Å—É
        $('#progress-categories a').click(function(e) {
            e.preventDefault();
            $('#progress-categories a').removeClass('active');
            $(this).addClass('active');
            currentCategory = $(this).data('category');
            loadProgressRecords();
            updateChart();
        });

        // –§—ñ–ª—å—Ç—Ä–∏
        $('#period-filter').change(function() {
            currentPeriod = $(this).val();
            loadProgressRecords();
            updateChart();
        });

        // –¢–∏–ø –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
        $('input[name="view-type"]').change(function() {
            currentViewType = $(this).val();
            toggleViewType();
        });

        // –¢–∏–ø –≥—Ä–∞—Ñ—ñ–∫–∞
        $('input[name="chart-type"]').change(function() {
            updateChart();
        });

        // –ú–æ–¥–∞–ª—å–Ω—ñ –≤—ñ–∫–Ω–∞
        $('#add-progress-btn').click(() => $('#addProgressModal').modal('show'));
        $('#add-goal-btn').click(() => $('#addGoalModal').modal('show'));

        // –§–æ—Ä–º–∏
        $('#add-progress-form').submit(handleAddProgress);
        $('#add-goal-form').submit(handleAddGoal);
        $('#edit-goal-form').submit(handleEditGoal);

        // –ó–º—ñ–Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó –ø—Ä–æ–≥—Ä–µ—Å—É
        $('#progress-category').change(function() {
            loadMetricsForCategory($(this).val());
        });

        // –°–ª–∞–π–¥–µ—Ä —Ä–µ–π—Ç–∏–Ω–≥—É
        $('#progress-rating').on('input', function() {
            $('#rating-value').text($(this).val());
        });

        // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–≤—ñ—Ç—É
        $('#generate-report-btn').click(generateReport);
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–æ—ó —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    function loadOverallStats() {
        apiRequest('/api/progress/statistics/')
            .then(stats => {
                updateOverallProgress(stats.overall_progress || 0);
                $('#completed-sessions').text(stats.completed_sessions || 0);
                $('#sessions-change').text(`+${stats.sessions_change || 0} —Ü—å–æ–≥–æ —Ç–∏–∂–Ω—è`);
                $('#improvement-score').text(stats.improvement_score || 0);
                $('#score-change').text(`+${stats.score_change || 0} –∑–∞ –º—ñ—Å—è—Ü—å`);
                $('#goals-achieved').text(stats.goals_achieved || 0);
                $('#goals-total').text(`–∑ ${stats.total_goals || 0} –∑–∞–≥–∞–ª–æ–º`);

                // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫—ñ–≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
                updateCategoryCounts(stats.category_counts || {});
            })
            .catch(error => {
                console.error('Error loading statistics:', error);
            });
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∫—ñ–ª—å—Ü–µ–≤–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—É
    function updateOverallProgress(percentage) {
        const circle = document.getElementById('overall-progress-ring');
        const circumference = 2 * Math.PI * 30; // r = 30
        const offset = circumference - (percentage / 100) * circumference;

        circle.style.strokeDasharray = `${circumference} ${circumference}`;
        circle.style.strokeDashoffset = offset;

        $('#overall-progress-text').text(`${Math.round(percentage)}%`);

        // –ó–º—ñ–Ω–∞ –∫–æ–ª—å–æ—Ä—É –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø—Ä–æ–≥—Ä–µ—Å—É
        if (percentage < 30) {
            circle.style.stroke = '#dc3545';
        } else if (percentage < 70) {
            circle.style.stroke = '#ffc107';
        } else {
            circle.style.stroke = '#28a745';
        }
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –ª—ñ—á–∏–ª—å–Ω–∏–∫—ñ–≤ –∫–∞—Ç–µ–≥–æ—Ä—ñ–π
    function updateCategoryCounts(counts) {
        Object.keys(counts).forEach(category => {
            $(`#${category}-count`).text(counts[category]);
        });
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤ –ø—Ä–æ–≥—Ä–µ—Å—É
    function loadProgressRecords() {
        const params = new URLSearchParams({
            category: currentCategory === 'all' ? '' : currentCategory,
            period: currentPeriod,
            limit: currentViewType === 'list' ? 50 : 10
        });

        apiRequest(`/api/progress/records/?${params}`)
            .then(records => {
                displayProgressRecords(records);
                if (currentViewType === 'chart') {
                    updateChart(records);
                }
            })
            .catch(error => {
                console.error('Error loading progress records:', error);
                $('#progress-records').html(`
                    <div class="empty-state">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h5>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</h5>
                        <p>–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–≥—Ä–µ—Å—É</p>
                    </div>
                `);
            });
    }

    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤ –ø—Ä–æ–≥—Ä–µ—Å—É
    function displayProgressRecords(records) {
        if (records.length === 0) {
            $('#progress-records').html(`
                <div class="empty-state">
                    <i class="fas fa-chart-line"></i>
                    <h5>–ó–∞–ø–∏—Å–∏ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω—ñ</h5>
                    <p>–î–æ–¥–∞–π—Ç–µ —Å–≤—ñ–π –ø–µ—Ä—à–∏–π –∑–∞–ø–∏—Å –ø—Ä–æ–≥—Ä–µ—Å—É</p>
                    <button class="btn btn-primary" onclick="$('#addProgressModal').modal('show')">
                        –î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å
                    </button>
                </div>
            `);
            return;
        }

        let html = '';
        records.forEach((record, index) => {
            html += generateProgressRecordCard(record, index > 0 ? records[index - 1] : null);
        });

        $('#progress-records').html(html);
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–∞—Ä—Ç–∫–∏ –∑–∞–ø–∏—Å—É –ø—Ä–æ–≥—Ä–µ—Å—É
    function generateProgressRecordCard(record, previousRecord) {
        const trendClass = getTrendClass(record, previousRecord);
        const trendIcon = getTrendIcon(record, previousRecord);
        const categoryClass = `category-${record.category}`;
        const moodEmoji = getMoodEmoji(record.mood);

        return `
            <div class="progress-record ${trendClass}" onclick="viewProgressDetails(${record.id})">
                <div class="d-flex align-items-center">
                    <div class="category-icon ${categoryClass}">
                        <i class="${getCategoryIcon(record.category)}"></i>
                    </div>
                    <div class="flex-grow-1">
                        <div class="d-flex justify-content-between align-items-start mb-2">
                            <div>
                                <h6 class="mb-1">${getCategoryText(record.category)}</h6>
                                <p class="text-muted mb-1">${record.metric_name}</p>
                                <small class="text-muted">${formatDate(record.date)}</small>
                            </div>
                            <div class="text-end">
                                <div class="h5 mb-1">
                                    ${record.value} ${record.unit}
                                    <i class="${trendIcon.icon} ${trendIcon.class} ms-1"></i>
                                </div>
                                <div class="rating-display">
                                    <small class="text-muted">–û—Ü—ñ–Ω–∫–∞:</small>
                                    <div class="rating-bar">
                                        <div class="rating-fill rating-${record.rating}" style="width: ${record.rating * 10}%"></div>
                                    </div>
                                    <small class="text-muted">${record.rating}/10</small>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                ${record.notes ? `
                                    <small class="text-muted">
                                        <i class="fas fa-sticky-note me-1"></i>
                                        ${record.notes.substring(0, 50)}${record.notes.length > 50 ? '...' : ''}
                                    </small>
                                ` : ''}
                            </div>
                            <div class="d-flex align-items-center">
                                ${record.mood ? `<span class="mood-emoji me-2">${moodEmoji}</span>` : ''}
                                ${record.shared_with_doctor ? '<i class="fas fa-share-alt text-primary" title="–ü–æ–¥—ñ–ª–µ–Ω–æ –∑ –ª—ñ–∫–∞—Ä–µ–º"></i>' : ''}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        `;
    }

    // –ü–µ—Ä–µ–≥–ª—è–¥ –¥–µ—Ç–∞–ª–µ–π –∑–∞–ø–∏—Å—É
    function viewProgressDetails(recordId) {
        selectedProgressId = recordId;

        apiRequest(`/api/progress/records/${recordId}/`)
            .then(record => {
                displayProgressDetails(record);
                $('#progressDetailsModal').modal('show');
            })
            .catch(error => {
                console.error('Error loading progress details:', error);
                showErrorMessage('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–µ—Ç–∞–ª–µ–π –∑–∞–ø–∏—Å—É');
            });
    }

    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–µ—Ç–∞–ª–µ–π –≤ –º–æ–¥–∞–ª—å–Ω–æ–º—É –≤—ñ–∫–Ω—ñ
    function displayProgressDetails(record) {
        $('#detail-category').text(getCategoryText(record.category));
        $('#detail-date').text(formatDate(record.date));
        $('#detail-metric').text(record.metric_name);
        $('#detail-value').text(`${record.value} ${record.unit}`);
        $('#detail-rating').text(`${record.rating}/10`);
        $('#detail-mood').html(getMoodEmoji(record.mood));
        $('#detail-notes').text(record.notes || '–ü—Ä–∏–º—ñ—Ç–∫–∏ –≤—ñ–¥—Å—É—Ç–Ω—ñ');

        // –¢—Ä–µ–Ω–¥
        const trend = calculateTrend(record);
        $('#detail-trend').html(`
            <span class="trend-${trend.direction}">
                <i class="fas fa-arrow-${trend.direction === 'up' ? 'up' : trend.direction === 'down' ? 'down' : 'right'}"></i>
                ${trend.text}
            </span>
        `);
    }

    // –û–±—Ä–æ–±–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –∑–∞–ø–∏—Å—É –ø—Ä–æ–≥—Ä–µ—Å—É
    function handleAddProgress(e) {
        e.preventDefault();

        const formData = new FormData(e.target);
        const progressData = {
            category: formData.get('category'),
            metric: formData.get('metric'),
            value: formData.get('value'),
            date: formData.get('date'),
            rating: formData.get('rating'),
            mood: formData.get('mood'),
            notes: formData.get('notes'),
            share_with_doctor: formData.get('share_with_doctor') === 'on'
        };

        apiRequest('/api/progress/records/', 'POST', progressData)
            .then(response => {
                $('#addProgressModal').modal('hide');
                $('#add-progress-form')[0].reset();
                showSuccessMessage('–ó–∞–ø–∏—Å –ø—Ä–æ–≥—Ä–µ—Å—É –¥–æ–¥–∞–Ω–æ!');
                loadOverallStats();
                loadProgressRecords();
            })
            .catch(error => {
                console.error('Error adding progress:', error);
                showErrorMessage('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—ñ –∑–∞–ø–∏—Å—É');
            });
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–µ—Ç—Ä–∏–∫ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä—ñ—ó
    function loadMetricsForCategory(category) {
        if (!category) {
            $('#progress-metric').html('<option value="">–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –∫–∞—Ç–µ–≥–æ—Ä—ñ—é</option>');
            return;
        }

        apiRequest(`/api/progress/metrics/?category=${category}`)
            .then(metrics => {
                let optionsHtml = '<option value="">–û–±–µ—Ä—ñ—Ç—å –ø–æ–∫–∞–∑–Ω–∏–∫</option>';
                metrics.forEach(metric => {
                    optionsHtml += `<option value="${metric.id}" data-unit="${metric.unit}">${metric.name}</option>`;
                });
                $('#progress-metric').html(optionsHtml);
            })
            .catch(error => {
                console.error('Error loading metrics:', error);
                $('#progress-metric').html('<option value="">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</option>');
            });

        // –ó–º—ñ–Ω–∞ –æ–¥–∏–Ω–∏—Ü—ñ –≤–∏–º—ñ—Ä—é–≤–∞–Ω–Ω—è
        $('#progress-metric').change(function() {
            const selectedOption = $(this).find('option:selected');
            const unit = selectedOption.data('unit') || '–æ–¥.';
            $('#progress-unit').text(unit);
        });
    }

    // –û–Ω–æ–≤–ª–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫–∞
    function updateChart(data = null) {
        if (currentViewType !== 'chart') return;

        const ctx = document.getElementById('progress-chart').getContext('2d');

        if (progressChart) {
            progressChart.destroy();
        }

        const chartType = $('input[name="chart-type"]:checked').val() === 'bar-chart' ? 'bar' : 'line';

        // –Ø–∫—â–æ –¥–∞–Ω—ñ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω—ñ, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —ó—Ö
        if (!data) {
            const params = new URLSearchParams({
                category: currentCategory === 'all' ? '' : currentCategory,
                period: currentPeriod,
                chart_data: true
            });

            apiRequest(`/api/progress/chart/?${params}`)
                .then(chartData => {
                    createChart(ctx, chartType, chartData);
                })
                .catch(error => {
                    console.error('Error loading chart data:', error);
                });
        } else {
            const chartData = prepareChartData(data);
            createChart(ctx, chartType, chartData);
        }
    }

    // –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫–∞
    function createChart(ctx, type, data) {
        progressChart = new Chart(ctx, {
            type: type,
            data: {
                labels: data.labels,
                datasets: data.datasets
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'top'
                    },
                    tooltip: {
                        mode: 'index',
                        intersect: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: '–ó–Ω–∞—á–µ–Ω–Ω—è'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: '–ü–µ—Ä—ñ–æ–¥'
                        }
                    }
                },
                interaction: {
                    mode: 'nearest',
                    axis: 'x',
                    intersect: false
                }
            }
        });
    }

    // –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è –≥—Ä–∞—Ñ—ñ–∫–∞
    function prepareChartData(records) {
        const labels = [];
        const data = [];
        const colors = {
            mobility: '#667eea',
            strength: '#f5576c',
            flexibility: '#00f2fe',
            balance: '#38f9d7',
            pain: '#fee140',
            cognitive: '#fed6e3',
            speech: '#fcb69f'
        };

        records.forEach(record => {
            labels.push(formatDate(record.date));
            data.push(record.value);
        });

        return {
            labels: labels,
            datasets: [{
                label: currentCategory === 'all' ? '–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å' : getCategoryText(currentCategory),
                data: data,
                borderColor: colors[currentCategory] || '#007bff',
                backgroundColor: colors[currentCategory] ? colors[currentCategory] + '20' : '#007bff20',
                tension: 0.4,
                fill: true
            }]
        };
    }

    // –ü–µ—Ä–µ–º–∏–∫–∞–Ω–Ω—è —Ç–∏–ø—É –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
    function toggleViewType() {
        $('#progress-chart-card, #progress-list-card, #progress-calendar-card').hide();

        switch(currentViewType) {
            case 'chart':
                $('#progress-chart-card').show();
                updateChart();
                break;
            case 'list':
                $('#progress-list-card').show();
                loadProgressRecords();
                break;
            case 'calendar':
                $('#progress-calendar-card').show();
                loadProgressCalendar();
                break;
        }
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø—Ä–æ–≥—Ä–µ—Å—É
    function loadProgressCalendar() {
        apiRequest(`/api/progress/calendar/?period=${currentPeriod}`)
            .then(calendarData => {
                generateProgressCalendar(calendarData);
            })
            .catch(error => {
                console.error('Error loading calendar:', error);
                $('#progress-calendar').html(`
                    <div class="empty-state">
                        <i class="fas fa-calendar-times"></i>
                        <h5>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è</h5>
                    </div>
                `);
            });
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –ø—Ä–æ–≥—Ä–µ—Å—É
    function generateProgressCalendar(data) {
        // –¢—É—Ç –±—É–¥–µ –ª–æ–≥—ñ–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –∫–∞–ª–µ–Ω–¥–∞—Ä—è
        let calendarHtml = '<div class="text-center text-muted py-4">–ö–∞–ª–µ–Ω–¥–∞—Ä –≤ —Ä–æ–∑—Ä–æ–±—Ü—ñ</div>';
        $('#progress-calendar').html(calendarHtml);
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ü—ñ–ª–µ–π
    function loadGoals() {
        apiRequest('/api/progress/goals/')
            .then(goals => {
                displayGoals(goals);
            })
            .catch(error => {
                console.error('Error loading goals:', error);
                $('#current-goals').html(`
                    <div class="empty-state">
                        <i class="fas fa-bullseye"></i>
                        <h6>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Ü—ñ–ª–µ–π</h6>
                    </div>
                `);
            });
    }

    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è —Ü—ñ–ª–µ–π
    function displayGoals(goals) {
        if (goals.length === 0) {
            $('#current-goals').html(`
                <div class="empty-state">
                    <i class="fas fa-bullseye"></i>
                    <h6>–ù–µ–º–∞—î –∞–∫—Ç–∏–≤–Ω–∏—Ö —Ü—ñ–ª–µ–π</h6>
                    <p class="small">–î–æ–¥–∞–π—Ç–µ —Å–≤–æ—é –ø–µ—Ä—à—É —Ü—ñ–ª—å</p>
                    <button class="btn btn-sm btn-primary" onclick="$('#addGoalModal').modal('show')">
                        –î–æ–¥–∞—Ç–∏ —Ü—ñ–ª—å
                    </button>
                </div>
            `);
            return;
        }

        let html = '';
        goals.forEach(goal => {
            html += generateGoalCard(goal);
        });

        $('#current-goals').html(html);
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–∞—Ä—Ç–∫–∏ —Ü—ñ–ª—ñ
    function generateGoalCard(goal) {
        const progress = (goal.current_value / goal.target_value) * 100;
        const priorityClass = `priority-${goal.priority}`;
        const daysLeft = Math.ceil((new Date(goal.target_date) - new Date()) / (1000 * 60 * 60 * 24));

        return `
            <div class="goal-card ${priorityClass}">
                <div class="d-flex justify-content-between align-items-start mb-2">
                    <h6 class="mb-1">${goal.title}</h6>
                    <span class="badge bg-${goal.priority === 'high' ? 'danger' : goal.priority === 'medium' ? 'warning' : 'success'}">
                        ${goal.priority === 'high' ? '–í–∏—Å–æ–∫–∏–π' : goal.priority === 'medium' ? '–°–µ—Ä–µ–¥–Ω—ñ–π' : '–ù–∏–∑—å–∫–∏–π'}
                    </span>
                </div>

                ${goal.description ? `<p class="text-muted small mb-2">${goal.description}</p>` : ''}

                <div class="goal-progress mb-2">
                    <div class="goal-progress-bar bg-primary" style="width: ${Math.min(progress, 100)}%"></div>
                </div>

                <div class="d-flex justify-content-between align-items-center">
                    <small class="text-muted">
                        ${goal.current_value} / ${goal.target_value} ${goal.unit || ''}
                    </small>
                    <small class="text-muted">
                        ${daysLeft > 0 ? `${daysLeft} –¥–Ω—ñ–≤ –∑–∞–ª–∏—à–∏–ª–æ—Å—å` : '–ü—Ä–æ—Å—Ç—Ä–æ—á–µ–Ω–æ'}
                    </small>
                </div>

                <div class="mt-2">
                    <div class="btn-group btn-group-sm w-100" role="group">
                        <button class="btn btn-outline-primary" onclick="updateGoal(${goal.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-outline-success" onclick="addGoalProgress(${goal.id})">
                            <i class="fas fa-plus"></i> –ü—Ä–æ–≥—Ä–µ—Å
                        </button>
                        <button class="btn btn-outline-danger" onclick="deleteGoal(${goal.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </div>
            </div>
        `;
    }

    // –û–±—Ä–æ–±–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ü—ñ–ª—ñ
    function handleAddGoal(e) {
        e.preventDefault();

        const formData = new FormData(e.target);
        const goalData = {
            title: formData.get('title'),
            description: formData.get('description'),
            category: formData.get('category'),
            target_date: formData.get('target_date'),
            current_value: formData.get('current_value'),
            target_value: formData.get('target_value'),
            priority: formData.get('priority')
        };

        apiRequest('/api/progress/goals/', 'POST', goalData)
            .then(response => {
                $('#addGoalModal').modal('hide');
                $('#add-goal-form')[0].reset();
                showSuccessMessage('–¶—ñ–ª—å —Å—Ç–≤–æ—Ä–µ–Ω–∞!');
                loadGoals();
                loadOverallStats();
            })
            .catch(error => {
                console.error('Error adding goal:', error);
                showErrorMessage('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ü—ñ–ª—ñ');
            });
    }

    function handleEditGoal(e) {
        e.preventDefault();

        const goalId = $('#edit-goal-id').val();
        const formData = new FormData(e.target);
        const goalData = {
            title: formData.get('title'),
            description: formData.get('description'),
            category: formData.get('category'),
            target_date: formData.get('target_date'),
            current_value: formData.get('current_value'),
            target_value: formData.get('target_value'),
            priority: formData.get('priority')
        };

        apiRequest(`/api/progress/goals/${goalId}/`, 'PUT', goalData)
            .then(response => {
                $('#editGoalModal').modal('hide');
                showSuccessMessage('–¶—ñ–ª—å –æ–Ω–æ–≤–ª–µ–Ω–∞!');
                loadGoals();
                loadOverallStats();
            })
            .catch(error => {
                console.error('Error updating goal:', error);
                showErrorMessage('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–Ω–æ–≤–ª–µ–Ω–Ω—ñ —Ü—ñ–ª—ñ');
            });
    }

    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ—Å—è–≥–Ω–µ–Ω—å
    function loadAchievements() {
        apiRequest('/api/progress/achievements/')
            .then(achievements => {
                displayAchievements(achievements);
            })
            .catch(error => {
                console.error('Error loading achievements:', error);
                $('#achievements').html(`
                    <div class="empty-state">
                        <i class="fas fa-trophy"></i>
                        <h6>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ—Å—è–≥–Ω–µ–Ω—å</h6>
                    </div>
                `);
            });
    }

    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –¥–æ—Å—è–≥–Ω–µ–Ω—å
    function displayAchievements(achievements) {
        if (achievements.length === 0) {
            $('#achievements').html(`
                <div class="empty-state">
                    <i class="fas fa-trophy"></i>
                    <h6>–ü–æ–∫–∏ –Ω–µ–º–∞—î –¥–æ—Å—è–≥–Ω–µ–Ω—å</h6>
                    <p class="small">–ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –Ω–∞–¥ —Å–≤–æ—ó–º –ø—Ä–æ–≥—Ä–µ—Å–æ–º!</p>
                </div>
            `);
            return;
        }

        let html = '';
        achievements.forEach(achievement => {
            html += `
                <div class="achievement-badge" title="${achievement.description}">
                    <i class="fas fa-${achievement.icon} me-1"></i>
                    ${achievement.title}
                </div>
            `;
        });

        $('#achievements').html(html);
    }

    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–≤—ñ—Ç—É
    function generateReport() {
        showInfoMessage('–ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑–≤—ñ—Ç—É...');

        const params = new URLSearchParams({
            category: currentCategory === 'all' ? '' : currentCategory,
            period: currentPeriod,
            format: 'pdf'
        });

        window.open(`/api/progress/report/?${params}`, '_blank');
    }

    // –î–æ–ø–æ–º—ñ–∂–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
    function getTrendClass(record, previousRecord) {
        if (!previousRecord) return 'stable';

        const diff = record.value - previousRecord.value;
        if (Math.abs(diff) < 0.1) return 'stable';
        return diff > 0 ? 'improved' : 'declined';
    }

    function getTrendIcon(record, previousRecord) {
        const trendClass = getTrendClass(record, previousRecord);

        switch(trendClass) {
            case 'improved':
                return { icon: 'fas fa-arrow-up', class: 'trend-up' };
            case 'declined':
                return { icon: 'fas fa-arrow-down', class: 'trend-down' };
            default:
                return { icon: 'fas fa-minus', class: 'trend-stable' };
        }
    }

    function getMoodEmoji(mood) {
        const moods = {
            1: 'üòû',
            2: 'üòê',
            3: 'üôÇ',
            4: 'üòä',
            5: 'üòÑ'
        };
        return moods[mood] || 'üòê';
    }

    function getCategoryIcon(category) {
        const icons = {
            mobility: 'fas fa-walking',
            strength: 'fas fa-dumbbell',
            flexibility: 'fas fa-expand-arrows-alt',
            balance: 'fas fa-balance-scale',
            pain: 'fas fa-heart-broken',
            cognitive: 'fas fa-brain',
            speech: 'fas fa-comments'
        };
        return icons[category] || 'fas fa-chart-line';
    }

    function getCategoryText(category) {
        const categories = {
            mobility: '–ú–æ–±—ñ–ª—å–Ω—ñ—Å—Ç—å',
            strength: '–°–∏–ª–∞',
            flexibility: '–ì–Ω—É—á–∫—ñ—Å—Ç—å',
            balance: '–†—ñ–≤–Ω–æ–≤–∞–≥–∞',
            pain: '–ë—ñ–ª—å',
            cognitive: '–ö–æ–≥–Ω—ñ—Ç–∏–≤–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó',
            speech: '–ú–æ–≤–ª–µ–Ω–Ω—è'
        };
        return categories[category] || '–Ü–Ω—à–µ';
    }

    function calculateTrend(record) {
        // –õ–æ–≥—ñ–∫–∞ —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—É —Ç—Ä–µ–Ω–¥—É
        return {
            direction: 'up',
            text: '–ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è'
        };
    }

    function formatDate(dateString) {
        const date = new Date(dateString);
        return date.toLocaleDateString('uk-UA', {
            day: 'numeric',
            month: 'short',
            year: 'numeric'
        });
    }

    // –î–æ–¥–∞—Ç–∫–æ–≤—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è —Ü—ñ–ª–µ–π
    function updateGoal(goalId) {
        // Load goal data and populate edit form
        apiRequest(`/api/progress/goals/${goalId}/`)
            .then(goal => {
                $('#edit-goal-id').val(goal.id);
                $('#edit-goal-title').val(goal.title);
                $('#edit-goal-description').val(goal.description);
                $('#edit-goal-category').val(goal.category);
                $('#edit-goal-target-date').val(goal.target_date);
                $('#edit-goal-current-value').val(goal.current_value);
                $('#edit-goal-target-value').val(goal.target_value);
                $('#edit-goal-priority').val(goal.priority);
                
                $('#editGoalModal').modal('show');
            })
            .catch(error => {
                console.error('Error loading goal:', error);
                showErrorMessage('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ü—ñ–ª—ñ');
            });
    }

    function addGoalProgress(goalId) {
        // Set the goal ID and show the add progress modal
        $('#progress-goal-id').val(goalId);
        
        // Load goal details to show in the modal
        apiRequest(`/api/progress/goals/${goalId}/`)
            .then(goal => {
                // You can add goal info display here if needed
                $('#addProgressModal').modal('show');
            })
            .catch(error => {
                console.error('Error loading goal:', error);
                showErrorMessage('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–∞–Ω–∏—Ö —Ü—ñ–ª—ñ');
            });
    }

    function deleteGoal(goalId) {
        if (confirm('–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é —Ü—ñ–ª—å?')) {
            apiRequest(`/api/progress/goals/${goalId}/`, 'DELETE')
                .then(() => {
                    showSuccessMessage('–¶—ñ–ª—å –≤–∏–¥–∞–ª–µ–Ω–æ');
                    loadGoals();
                    loadOverallStats();
                })
                .catch(error => {
                    console.error('Error deleting goal:', error);
                    showErrorMessage('–ü–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –≤–∏–¥–∞–ª–µ–Ω–Ω—ñ —Ü—ñ–ª—ñ');
                });
        }
    }

    // –§—É–Ω–∫—Ü—ñ—ó –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
    function showSuccessMessage(message) {
        const toast = $(`
            <div class="toast align-items-center text-white bg-success border-0" role="alert" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            </div>
        `);

        $('body').append(toast);
        toast.toast('show');
        setTimeout(() => toast.remove(), 5000);
    }

    function showErrorMessage(message) {
        const toast = $(`
            <div class="toast align-items-center text-white bg-danger border-0" role="alert" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            </div>
        `);

        $('body').append(toast);
        toast.toast('show');
        setTimeout(() => toast.remove(), 5000);
    }

    function showInfoMessage(message) {
        const toast = $(`
            <div class="toast align-items-center text-white bg-info border-0" role="alert" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
                <div class="d-flex">
                    <div class="toast-body">${message}</div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                </div>
            </div>
        `);

        $('body').append(toast);
        toast.toast('show');
        setTimeout(() => toast.remove(), 5000);
    }
</script>
{% endblock %}